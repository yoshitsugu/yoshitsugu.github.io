<!DOCTYPE html>
<html lang="ja">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
        <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">
        <meta http-equiv="X-UA-Compatible" content="IE=Edge">
        <title>Slack Slashコマンド + Rust で遊んだ - TSUGULOG</title>
        <meta name="description" content="yoshitsugu's blog">
        <link rel="shortcut icon" href="../images/favicon.ico" type="image/x-icon">
        <link rel="icon" href="../images/favicon.ico" type="image/x-icon">
        <meta property="og:title" content="Slack Slashコマンド + Rust で遊んだ - TSUGULOG" />
        <meta property="og:type" content="blog" />
        <meta property="og:image" content="https://yoshitsugu.net/images/title.png" />
        <meta property="og:site_name" content="TSUGULOG" />
        <meta property="og:url" content="https://yoshitsugu.net/posts/2017-02-10-slack-slash-pomo.html" />
        <meta property="og:description" content="弊社ブログに書いたが、Slack Slashコマンドでポモドーロ数を測れるようにした。
https://github.com/yoshitsugu/slash-pomo
背景などは弊社ブログに書いた通りなので、ここでは実装面について書く。" />
        <meta name="twitter:card" content="summary" />
        <meta name="twitter:site" content="@_yoshitsugu" />
        <meta name="twitter:title" content="Slack Slashコマンド + Rust で遊んだ - TSUGULOG" />
        <meta name="twitter:image" content="https://yoshitsugu.net/images/title.png" />
        <meta name="twitter:description" content="弊社ブログに書いたが、Slack Slashコマンドでポモドーロ数を測れるようにした。
https://github.com/yoshitsugu/slash-pomo
背景などは弊社ブログに書いた通りなので、ここでは実装面について書く。" />
        <link rel="stylesheet" href="../css/pure-min.css">
        <link rel="stylesheet" href="../css/grids-responsive-min.css">
        <link rel="stylesheet" href="../css/blog.css">
        <link rel="stylesheet" href="../css/highlight.css">
        <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
    </head>
    <body>
        <div id="wrapper">
            <div id="container">
                <header id="header" class="pure-menu pure-menu-horizontal">
                    <div id="logo" class="pure-menu-heading pure-menu-link">
                        <a href="../" class="pure-menu-link">TSUGULOG</a>
                    </div>
                    <ul class="pure-menu-list header-menu">
                        <li class="pure-menu-item"><a href="../" class="pure-menu-link">Home</a></li>
                        <li class="pure-menu-item"><a href="../archive.html" class="pure-menu-link">Archive</a></li>
                        <li class="pure-menu-item"><a href="../about.html" class="pure-menu-link">About</a></li>
                    </ul>
                </header>
                <div id="content">
                    <h1>Slack Slashコマンド + Rust で遊んだ</h1>
                    
                    <div class="info">
    <span class="date">Posted on February 10, 2017</span>
    
    
    <span class="tags">, Tags: <a href="../tags/Slack.html">Slack</a>, <a href="../tags/Rust.html">Rust</a></span>
    
</div>

<p><a href="http://sikmi.com/blog/sikmi_kaizen/slack-slash-command-pomodoro">弊社ブログ</a>に書いたが、Slack Slashコマンドでポモドーロ数を測れるようにした。<br />
<a href="https://github.com/yoshitsugu/slash-pomo">https://github.com/yoshitsugu/slash-pomo</a><br />
背景などは弊社ブログに書いた通りなので、ここでは実装面について書く。<!--more--></p>
<h2 id="使った言語ライブラリなど">使った言語、ライブラリなど</h2>
<h3 id="rust"><a href="https://www.rust-lang.org">Rust</a></h3>
<p>個人的に今勉強中なのでRustで書いてみた。<br />
このツール自体は社内で使ってもらっているが、実装は業務外の時間にやった&amp;別になくても困らないものなので、趣味優先にした。</p>
<h3 id="rocket"><a href="https://rocket.rs/">Rocket</a></h3>
<p>ついでにWebフレームワークも最近でたRocketを使っている。<br />
RustのWebフレームワークとしては<a href="http://nickel.rs/">nickel</a>とか<a href="http://ironframework.io/">Iron</a>などがあるようだ。<br />
Rocketは最近v0.2.0がでたが、まだ追従できていない。(現在0.1.6)</p>
<h3 id="redis"><a href="https://redis.io/">Redis</a></h3>
<p>カウントの記憶にはRedisを使った。<br />
普段手軽に使っているものなので使ったが、他にも選択肢はいろいろあったかもしれない。あまり調べられてはいない。<br />
RustからRedisを呼び出すのには<a href="https://github.com/mitsuhiko/redis-rs">redis-rs</a>を使った。</p>
<h2 id="実行環境">実行環境</h2>
<h3 id="ibm-bluemix"><a href="https://www.ibm.com/cloud-computing/jp/ja/bluemix/">IBM Bluemix</a></h3>
<p>Webサーバを動かす環境としてはIBMのBluemixを使った。<br />
HerokuではないのはSlashコマンドの仕様として3秒以内にレスポンスしないとタイムアウトしてしまう<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>ため、しばらくするとsleepしてしまうHerokuだと厳しかったから。<br />
Redisは<a href="https://console.ng.bluemix.net/catalog/services/redis-cloud">Redis Cloud</a>を使った。30MBのプランなら無料なので便利だ。<br />
<a href="https://github.com/cloudfoundry-community/cf-docs-contrib/wiki/Buildpacks">公式wiki？</a>には<a href="https://github.com/emk/heroku-buildpack-rust">heroku-buildpack-rust</a>がそのまま使えると書いてあったが使えなかった。<a href="https://github.com/yoshitsugu/heroku-buildpack-rust">仕方なくforkしてちょっと修正した。</a></p>
<h2 id="感想">感想</h2>
<p>とりあえず動くものができたので追ってリファクタリングや自動テストなどやりたい。<br />
多分慣れている人が見たらまだまだツッコミどころ満載のコードだと思うが個人的には大分Rustの感覚が養われてきたように思う。この段階で再度基礎の勉強をしてもいいかもしれないと思っている。<br />
また、こういうオモチャみたいなものでも、動くものを作るのはやはり楽しい。</p>
<section class="footnotes">
<hr />
<ol>
<li id="fn1"><p><a href="https://api.slack.com/slash-commands">https://api.slack.com/slash-commands</a> には一応3秒以内に返せない場合の解決策もあるがシンプルにやりたかった。<a href="#fnref1" class="footnote-back">↩</a></p></li>
</ol>
</section>

<div class="social-buttons">
<a href="http://b.hatena.ne.jp/entry/https://yoshitsugu.net/posts/2017-02-10-slack-slash-pomo.html" class="hatena-bookmark-button" data-hatena-bookmark-title="Slack Slashコマンド + Rust で遊んだ - TSUGULOG" data-hatena-bookmark-layout="standard-noballoon" data-hatena-bookmark-lang="en" title="このエントリーをはてなブックマークに追加"><img src="https://b.st-hatena.com/images/entry-button/button-only@2x.png" alt="このエントリーをはてなブックマークに追加" width="20" height="20" style="border: none;" /></a><script type="text/javascript" src="https://b.st-hatena.com/js/bookmark_button.js" charset="utf-8" async="async"></script>
<a href="https://twitter.com/share" class="twitter-share-button" data-via="_yoshitsugu">Tweet</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
</div>

                    
                </div>
            </div>
            <footer id="footer">
                &copy; 2016 Kota Yoshitsugu <br>
                This site is powered by
                <a href="http://jaspervdj.be/hakyll" target="_blank">Hakyll</a>
                , <a href="http://purecss.io/" target="_blank">Pure.css</a>
        </footer>
        
      </div>
      <script type="text/javascript" src="../js/ga.js"></script>
    </body>
</html>
