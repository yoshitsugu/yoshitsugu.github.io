<!DOCTYPE html>
<html lang="ja">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
        <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">
        <meta http-equiv="X-UA-Compatible" content="IE=Edge">
        <title>[Ruby on Rails] 5 idioms I always forget - TSUGULOG</title>
        <meta name="description" content="yoshitsugu's blog">
        <link rel="shortcut icon" href="../images/favicon.ico" type="image/x-icon">
        <link rel="icon" href="../images/favicon.ico" type="image/x-icon">
        <meta property="og:title" content="[Ruby on Rails] 5 idioms I always forget - TSUGULOG" />
        <meta property="og:type" content="blog" />
        <meta property="og:image" content="https://yoshitsugu.net/images/title.png" />
        <meta property="og:site_name" content="TSUGULOG" />
        <meta property="og:url" content="https://yoshitsugu.net/posts/2017-08-24-always-forget-idioms-on-rails.html" />
        <meta property="og:description" content="Ruby on Rails is the great web application framework. I usually use it in the current job. But I always forget some idioms. In this post, I try to write out them." />
        <meta name="twitter:card" content="summary" />
        <meta name="twitter:site" content="@_yoshitsugu" />
        <meta name="twitter:title" content="[Ruby on Rails] 5 idioms I always forget - TSUGULOG" />
        <meta name="twitter:image" content="https://yoshitsugu.net/images/title.png" />
        <meta name="twitter:description" content="Ruby on Rails is the great web application framework. I usually use it in the current job. But I always forget some idioms. In this post, I try to write out them." />
        <link rel="stylesheet" href="../css/pure-min.css">
        <link rel="stylesheet" href="../css/grids-responsive-min.css">
        <link rel="stylesheet" href="../css/blog.css">
        <link rel="stylesheet" href="../css/highlight.css">
        <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
    </head>
    <body>
        <div id="wrapper">
            <div id="container">
                <header id="header" class="pure-menu pure-menu-horizontal">
                    <div id="logo" class="pure-menu-heading pure-menu-link">
                        <a href="../" class="pure-menu-link">TSUGULOG</a>
                    </div>
                    <ul class="pure-menu-list header-menu">
                        <li class="pure-menu-item"><a href="../" class="pure-menu-link">Home</a></li>
                        <li class="pure-menu-item"><a href="../archive.html" class="pure-menu-link">Archive</a></li>
                        <li class="pure-menu-item"><a href="../about.html" class="pure-menu-link">About</a></li>
                    </ul>
                </header>
                <div id="content">
                    <h1>[Ruby on Rails] 5 idioms I always forget</h1>
                    
                    <div class="info">
    <span class="date">Posted on August 24, 2017</span>
    
    
    <span class="tags">, Tags: <a href="../tags/Ruby%20on%20Rails.html">Ruby on Rails</a></span>
    
</div>

<p>Ruby on Rails is the great web application framework. I usually use it in the current job. But I always forget some idioms. In this post, I try to write out them.<!--more--></p>
<h2 id="calling-helper-methods-in-model-methods">1. Calling helper methods in Model methods</h2>
<h3 id="idiom">Idiom</h3>
<p><code>ApplicationController.helpers.(helper name)</code></p>
<h3 id="example">Example</h3>
<div class="sourceCode" id="cb1"><pre class="sourceCode ruby"><code class="sourceCode ruby"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">class</span> <span class="dt">Post</span> &lt; <span class="dt">ApplicationRecord</span></a>
<a class="sourceLine" id="cb1-2" title="2">  <span class="kw">def</span> title_asterisk</a>
<a class="sourceLine" id="cb1-3" title="3">    <span class="dt">ApplicationController</span>.helpers.with_asterisk(title)</a>
<a class="sourceLine" id="cb1-4" title="4">  <span class="kw">end</span></a>
<a class="sourceLine" id="cb1-5" title="5"><span class="kw">end</span></a></code></pre></div>
<h2 id="calling-routing-helper-methods-in-model-methods">2. Calling routing helper methods in Model methods</h2>
<h3 id="idiom-1">Idiom</h3>
<p><code>Rails.application.routes.url_helpers.(routing helper name)</code></p>
<h3 id="example-1">Example</h3>
<div class="sourceCode" id="cb2"><pre class="sourceCode ruby"><code class="sourceCode ruby"><a class="sourceLine" id="cb2-1" title="1"><span class="kw">class</span> <span class="dt">Post</span> &lt; <span class="dt">ApplicationRecord</span></a>
<a class="sourceLine" id="cb2-2" title="2">  <span class="kw">def</span> new_or_edit_path</a>
<a class="sourceLine" id="cb2-3" title="3">    <span class="kw">if</span> persisted?</a>
<a class="sourceLine" id="cb2-4" title="4">      <span class="dt">Rails</span>.application.routes.url_helpers.new_post_path</a>
<a class="sourceLine" id="cb2-5" title="5">    <span class="kw">else</span></a>
<a class="sourceLine" id="cb2-6" title="6">      <span class="dt">Rails</span>.application.routes.url_helpers.post_path(<span class="dv">self</span>)</a>
<a class="sourceLine" id="cb2-7" title="7">    <span class="kw">end</span></a>
<a class="sourceLine" id="cb2-8" title="8">  <span class="kw">end</span></a>
<a class="sourceLine" id="cb2-9" title="9"><span class="kw">end</span></a></code></pre></div>
<h2 id="updating-models-attributes-without-saving-it-to-database">3. Updating Model’s attributes without saving it to Database</h2>
<h3 id="idiom-2">Idiom</h3>
<p><code>model.assign_attributes(attributes)</code></p>
<h3 id="example-2">Example</h3>
<div class="sourceCode" id="cb3"><pre class="sourceCode ruby"><code class="sourceCode ruby"><a class="sourceLine" id="cb3-1" title="1"><span class="kw">class</span> <span class="dt">PostController</span> &lt; <span class="dt">ApplicationController</span></a>
<a class="sourceLine" id="cb3-2" title="2">  <span class="kw">def</span> update</a>
<a class="sourceLine" id="cb3-3" title="3">    post = <span class="dt">Post</span>.find(params[<span class="st">:id</span>])</a>
<a class="sourceLine" id="cb3-4" title="4">    post.assign_attributes(post_params)</a>
<a class="sourceLine" id="cb3-5" title="5">    post.save! <span class="kw">if</span> post.valid?</a>
<a class="sourceLine" id="cb3-6" title="6">    redirect_to posts_path</a>
<a class="sourceLine" id="cb3-7" title="7">  <span class="kw">end</span></a>
<a class="sourceLine" id="cb3-8" title="8"><span class="kw">end</span></a></code></pre></div>
<h2 id="turning-off-updating-updated_at-when-saving-models">4. Turning off updating <code>updated_at</code> when saving Models</h2>
<h3 id="idiom-3">Idiom</h3>
<p><code>ActiveRecord::Base.record_timestamps = false</code></p>
<h3 id="example-3">Example</h3>
<div class="sourceCode" id="cb4"><pre class="sourceCode ruby"><code class="sourceCode ruby"><a class="sourceLine" id="cb4-1" title="1"><span class="kw">class</span> <span class="dt">PostImageUpdater</span></a>
<a class="sourceLine" id="cb4-2" title="2">  <span class="kw">def</span> execute</a>
<a class="sourceLine" id="cb4-3" title="3">    <span class="dt">ActiveRecord</span>::<span class="dt">Base</span>.record_timestamps = <span class="dv">false</span></a>
<a class="sourceLine" id="cb4-4" title="4">    <span class="dt">Post</span>.all.find_each <span class="kw">do</span> |post|</a>
<a class="sourceLine" id="cb4-5" title="5">      post.image = get_updated_image(post)</a>
<a class="sourceLine" id="cb4-6" title="6">    <span class="kw">end</span></a>
<a class="sourceLine" id="cb4-7" title="7">    <span class="dt">ActiveRecord</span>::<span class="dt">Base</span>.record_timestamps = <span class="dv">true</span></a>
<a class="sourceLine" id="cb4-8" title="8">  <span class="kw">end</span></a>
<a class="sourceLine" id="cb4-9" title="9"><span class="kw">end</span></a></code></pre></div>
<h2 id="basic-auth">5. Basic Auth</h2>
<h3 id="idiom-4">Idiom</h3>
<p><code>authenticate_or_request_with_http_basic(realm = "Application", &amp;login_procedure)</code></p>
<h3 id="example-4">Example</h3>
<div class="sourceCode" id="cb5"><pre class="sourceCode ruby"><code class="sourceCode ruby"><a class="sourceLine" id="cb5-1" title="1"><span class="kw">class</span> <span class="dt">WithBasicAuthController</span> &lt; <span class="dt">ApplicationController</span></a>
<a class="sourceLine" id="cb5-2" title="2">  before_action <span class="st">:basic_auth</span></a>
<a class="sourceLine" id="cb5-3" title="3"></a>
<a class="sourceLine" id="cb5-4" title="4">  <span class="kw">def</span> basic_auth</a>
<a class="sourceLine" id="cb5-5" title="5">    authenticate_or_request_with_http_basic(<span class="st">&quot;Application&quot;</span>) <span class="kw">do</span> |name, password|</a>
<a class="sourceLine" id="cb5-6" title="6">      name == <span class="dt">ENV</span>[<span class="st">'BASIC_AUTH_NAME'</span>] &amp;&amp; password == <span class="dt">ENV</span>[<span class="st">'BASIC_AUTH_PASSWORD'</span>]</a>
<a class="sourceLine" id="cb5-7" title="7">    <span class="kw">end</span></a>
<a class="sourceLine" id="cb5-8" title="8">  <span class="kw">end</span></a>
<a class="sourceLine" id="cb5-9" title="9"><span class="kw">end</span></a></code></pre></div>
<h2 id="and-more">And More…</h2>
<p>Maybe there are more idioms I always googling them. If anyone who have a good idea to remember them, please tell me :)</p>

<div class="social-buttons">
<a href="http://b.hatena.ne.jp/entry/https://yoshitsugu.net/posts/2017-08-24-always-forget-idioms-on-rails.html" class="hatena-bookmark-button" data-hatena-bookmark-title="[Ruby on Rails] 5 idioms I always forget - TSUGULOG" data-hatena-bookmark-layout="standard-noballoon" data-hatena-bookmark-lang="en" title="このエントリーをはてなブックマークに追加"><img src="https://b.st-hatena.com/images/entry-button/button-only@2x.png" alt="このエントリーをはてなブックマークに追加" width="20" height="20" style="border: none;" /></a><script type="text/javascript" src="https://b.st-hatena.com/js/bookmark_button.js" charset="utf-8" async="async"></script>
<a href="https://twitter.com/share" class="twitter-share-button" data-via="_yoshitsugu">Tweet</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
</div>

                    
                </div>
            </div>
            <footer id="footer">
                &copy; 2016 Kota Yoshitsugu <br>
                This site is powered by
                <a href="http://jaspervdj.be/hakyll" target="_blank">Hakyll</a>
                , <a href="http://purecss.io/" target="_blank">Pure.css</a>
        </footer>
        
      </div>
      <script type="text/javascript" src="../js/ga.js"></script>
    </body>
</html>
