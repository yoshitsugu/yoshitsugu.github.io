<!DOCTYPE html>
<html lang="ja">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
        <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">
        <meta http-equiv="X-UA-Compatible" content="IE=Edge">
        <title>Rustで機械学習 - TSUGULOG</title>
        <meta name="description" content="yoshitsugu's blog">
        <link rel="shortcut icon" href="../images/favicon.ico" type="image/x-icon">
        <link rel="icon" href="../images/favicon.ico" type="image/x-icon">
        <meta property="og:title" content="Rustで機械学習 - TSUGULOG" />
        <meta property="og:type" content="blog" />
        <meta property="og:image" content="https://yoshitsugu.net/images/title.png" />
        <meta property="og:site_name" content="TSUGULOG" />
        <meta property="og:url" content="https://yoshitsugu.net/posts/2017-11-14-beginning-machine-learning-with-rust.html" />
        <meta property="og:description" content="
    Posted on 2017-11-14
    
    
    , Tags: Rust, Machine Learning
    


最近、仕事ではじめる機械学習という本を読んでいる。現場感が伝わるように書いてあって、以前より機械学習に興味が沸いた。
ところで、最近勉強中のRustで機械学習系のライブラリはあるのか、気になったのでちょっと調べた。" />
        <meta name="twitter:card" content="summary" />
        <meta name="twitter:site" content="@_yoshitsugu" />
        <meta name="twitter:title" content="Rustで機械学習 - TSUGULOG" />
        <meta name="twitter:image" content="https://yoshitsugu.net/images/title.png" />
        <meta name="twitter:description" content="
    Posted on 2017-11-14
    
    
    , Tags: Rust, Machine Learning
    


最近、仕事ではじめる機械学習という本を読んでいる。現場感が伝わるように書いてあって、以前より機械学習に興味が沸いた。
ところで、最近勉強中のRustで機械学習系のライブラリはあるのか、気になったのでちょっと調べた。" />
        <link rel="stylesheet" href="../css/pure-min.css">
        <link rel="stylesheet" href="../css/grids-responsive-min.css">
        <link rel="stylesheet" href="../css/blog.css">
        <link rel="stylesheet" href="../css/highlight.css">
        <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
    </head>
    <body>
        <div id="wrapper">
            <div id="container">
                <header id="header" class="pure-menu pure-menu-horizontal">
                    <div id="logo" class="pure-menu-heading pure-menu-link">
                        <a href="../" class="pure-menu-link">TSUGULOG</a>
                    </div>
                    <ul class="pure-menu-list header-menu">
                        <li class="pure-menu-item"><a href="../" class="pure-menu-link">Home</a></li>
                        <li class="pure-menu-item"><a href="../archive.html" class="pure-menu-link">Archive</a></li>
                        <li class="pure-menu-item"><a href="../about.html" class="pure-menu-link">About</a></li>
                    </ul>
                </header>
                <div id="content">
                    <h1>Rustで機械学習</h1>
                    
                    <div class="info">
    <span class="date">Posted on 2017-11-14</span>
    
    
    <span class="tags">, Tags: <a title="All pages tagged 'Rust'." href="../tags/Rust.html" rel="tag">Rust</a>, <a title="All pages tagged 'Machine Learning'." href="../tags/Machine%20Learning.html" rel="tag">Machine Learning</a></span>
    
</div>

<p>最近、<a href="https://www.oreilly.co.jp/books/9784873118215/">仕事ではじめる機械学習</a>という本を読んでいる。現場感が伝わるように書いてあって、以前より機械学習に興味が沸いた。<br />
ところで、最近勉強中のRustで機械学習系のライブラリはあるのか、気になったのでちょっと調べた。<!--more--></p>
<h2 id="rustで機械学習">Rustで機械学習</h2>
<p>調べた感じだと以下のrusty-machineというのが汎用的に使えそうだった。</p>
<ul>
<li><a href="https://github.com/AtheMathmo/rusty-machine">rusty-machine: Machine Learning library for Rust</a></li>
</ul>
<p>錆びた機械というネーミングがかっこいい。<br />
READMEを見る限り、以下に対応しているようだ。</p>
<ul>
<li>線形回帰</li>
<li>ロジスティック回帰</li>
<li>一般線形モデル</li>
<li>k-meansクラスタリング</li>
<li>ニューラルネットワーク</li>
<li>ガウス過程回帰</li>
<li>サポートベクターマシン(SVM)</li>
<li>ナイーブベイズ</li>
<li>DBSCAN</li>
<li>k近傍法</li>
</ul>
<p>残念ながら、自分にはまだこれらの手法について正しく解説できる自信がないので、説明は省く。</p>
<h2 id="使ってみる">使ってみる</h2>
<p>今回はexampleにあるコードを使って、k-meansクラスタリングとそのプロットまでやった。<br />
プロットするのに、今回は <a href="https://github.com/SiegeLord/RustGnuplot">RustGnuplot</a> を使った。プロット系ライブラリは他にも以下のようなものがあるようだ。</p>
<ul>
<li><a href="https://github.com/milliams/plot">plot: Command-line plotting tool written in Rust</a></li>
<li><a href="https://github.com/coder543/dataplotlib">dataplotlib: Scientific plotting library for Rust</a></li>
</ul>
<p>まずはexampleのコードをそのままコピペして動かしてみる<br />
参考: <a href="https://github.com/AtheMathmo/rusty-machine/blob/master/examples/k-means_generating_cluster.rs">k-means_generating_cluster.rs</a></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> cargo run</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>    <span class="ex">Finished</span> dev [unoptimized + debuginfo] target<span class="er">(</span><span class="ex">s</span><span class="kw">)</span> <span class="er">in</span> <span class="ex">0.0</span> secs</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    <span class="ex">Running</span> <span class="kw">`</span><span class="ex">target/debug/mlrs</span><span class="kw">`</span> <span class="co"># &lt;- mlrsというパッケージ名にした</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="ex">K-Means</span> clustering example:</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="ex">Generating</span> 2000 samples from each centroids:</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="ex">⎡-0.5</span> <span class="at">-0.5⎤</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="ex">⎣</span>   0  0.5⎦</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="ex">Training</span> the model...</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="ex">Model</span> Centroids:</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="ex">⎡-0.505</span> <span class="at">-0.536⎤</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="ex">⎣</span> 0.015  0.539⎦</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="ex">Classifying</span> the samples...</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="ex">Samples</span> closest to first centroid: 1990</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="ex">Samples</span> closest to second centroid: 2010</span></code></pre></div>
<p>ちゃんと動く。<br />
次にRustGnuplotを導入する</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode rust"><code class="sourceCode rust"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">extern</span> <span class="kw">crate</span> gnuplot<span class="op">;</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="pp">gnuplot::</span><span class="op">*;</span></span></code></pre></div>
<p>predictした後、<code>classes</code>の値に従って、<code>samples</code>を分ける</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode rust"><code class="sourceCode rust"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> <span class="kw">mut</span> first_rows<span class="op">:</span> Matrix<span class="op">&lt;</span><span class="dt">f64</span><span class="op">&gt;</span> <span class="op">=</span> <span class="pp">Matrix::</span>new(<span class="dv">0</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="pp">vec!</span>[])<span class="op">;</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> <span class="kw">mut</span> second_rows<span class="op">:</span> Matrix<span class="op">&lt;</span><span class="dt">f64</span><span class="op">&gt;</span> <span class="op">=</span> <span class="pp">Matrix::</span>new(<span class="dv">0</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="pp">vec!</span>[])<span class="op">;</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i<span class="op">,</span> x) <span class="kw">in</span> samples<span class="op">.</span>iter_rows()<span class="op">.</span>enumerate() <span class="op">{</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> classes<span class="op">.</span>data()[i] <span class="op">==</span> <span class="dv">0</span> <span class="op">{</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>        first_rows <span class="op">=</span> first_rows<span class="op">.</span>vcat(<span class="op">&amp;</span><span class="pp">Matrix::</span>new(<span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> x))<span class="op">;</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>        second_rows <span class="op">=</span> second_rows<span class="op">.</span>vcat(<span class="op">&amp;</span><span class="pp">Matrix::</span>new(<span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> x))<span class="op">;</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>pngに描画する</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode rust"><code class="sourceCode rust"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> <span class="kw">mut</span> fg <span class="op">=</span> <span class="pp">Figure::</span>new()<span class="op">;</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> xs1 <span class="op">=</span> first_rows<span class="op">.</span>select_cols(<span class="op">&amp;</span>[<span class="dv">0</span>])<span class="op">.</span>into_vec()<span class="op">;</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> ys1 <span class="op">=</span> first_rows<span class="op">.</span>select_cols(<span class="op">&amp;</span>[<span class="dv">1</span>])<span class="op">.</span>into_vec()<span class="op">;</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> xs2 <span class="op">=</span> second_rows<span class="op">.</span>select_cols(<span class="op">&amp;</span>[<span class="dv">0</span>])<span class="op">.</span>into_vec()<span class="op">;</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> ys2 <span class="op">=</span> second_rows<span class="op">.</span>select_cols(<span class="op">&amp;</span>[<span class="dv">1</span>])<span class="op">.</span>into_vec()<span class="op">;</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>fg<span class="op">.</span>axes2d()</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span>points(xs1<span class="op">,</span> ys1<span class="op">,</span> <span class="op">&amp;</span>[Caption(<span class="st">&quot;Points1&quot;</span>)<span class="op">,</span> PointSymbol(<span class="ch">'x'</span>)<span class="op">,</span> Color(<span class="st">&quot;#008000&quot;</span>)<span class="op">,</span> PointSize(<span class="dv">0.5</span>)])</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span>points(xs2<span class="op">,</span> ys2<span class="op">,</span> <span class="op">&amp;</span>[Caption(<span class="st">&quot;Points2&quot;</span>)<span class="op">,</span> PointSymbol(<span class="ch">'o'</span>)<span class="op">,</span> Color(<span class="st">&quot;#ff4000&quot;</span>)<span class="op">,</span> PointSize(<span class="dv">0.5</span>)])</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span>set_title(<span class="st">&quot;Plot&quot;</span><span class="op">,</span> <span class="op">&amp;</span>[])<span class="op">;</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>fg<span class="op">.</span>set_terminal(<span class="st">&quot;pngcairo&quot;</span><span class="op">,</span> <span class="st">&quot;/tmp/fg1.png&quot;</span>)<span class="op">;</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>fg<span class="op">.</span>show()<span class="op">;</span></span></code></pre></div>
<p>すると、以下のような図がプロットできた。</p>
<p><img src="../images/rust-ml-01.png" class="blog-img img-responsive" /></p>
<p>コード全体は <a href="https://gist.github.com/yoshitsugu/344f41a5c67af70bf00696912068926d">こちらのGist</a> に置いた。</p>
<h2 id="まとめ">まとめ</h2>
<p>今回は軽くrusty-machineの例を動かした。図へのプロットも行った。<br />
まだまだ機械学習については知識がないので、これからもう少し高度なことができるようになったらまたブログを書く。</p>

<div class="social-buttons">
<a href="http://b.hatena.ne.jp/entry/https://yoshitsugu.net/posts/2017-11-14-beginning-machine-learning-with-rust.html" class="hatena-bookmark-button" data-hatena-bookmark-title="Rustで機械学習 - TSUGULOG" data-hatena-bookmark-layout="standard-noballoon" data-hatena-bookmark-lang="en" title="このエントリーをはてなブックマークに追加"><img src="https://b.st-hatena.com/images/entry-button/button-only@2x.png" alt="このエントリーをはてなブックマークに追加" width="20" height="20" style="border: none;" /></a><script type="text/javascript" src="https://b.st-hatena.com/js/bookmark_button.js" charset="utf-8" async="async"></script>
<a href="https://twitter.com/share" class="twitter-share-button" data-via="_yoshitsugu">Tweet</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
</div>

                    
                </div>
            </div>
            <footer id="footer">
                &copy; 2016 Kota Yoshitsugu <br>
                This site is powered by
                <a href="http://jaspervdj.be/hakyll" target="_blank">Hakyll</a>
                , <a href="http://purecss.io/" target="_blank">Pure.css</a>
        </footer>
        
      </div>
    </body>
</html>
